################################################################################
#                                                                              #
# db    db  .8888.  dP     888888b 8888ba   .8888.     d8b   db 888888b d8888P #
# 88    88 d8'  `8b 88     88      88  `8b d8'  `8b    88V8  88 88        88   #
# Y8    8P 88    88 88    a88aaa   88aa8P' 88    88    88 V8 88 88aaa     88   #
# `8b  d8' 88    88 88     88      88  `8b 88    88    88  V888 88        88   #
#  `8bd8'  Y8.  .8P 88     88      88  .88 Y8.  .8P dP 88   V88 88        88   #
#    YP     `888P'  88888P 888888P 888888'  `888P'  88 VP    8P 888888P   dP   #
#                                                                              #
################################################################################
#
# ExpressJS for volebo.net
#
# Copyright (C) 2016-2017 Volebo <dev@volebo.net>
# Copyright (C) 2016-2017 Maksim Koryukov <maxkoryukov@gmail.com>
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program. If not, see <http://www.gnu.org/licenses/>.

sudo: false

language: node_js

node_js:
  - 8

# env:
#  global:
#    - NODE_ENV=dev

#matrix:
  # include:
  #   - node_js: 4
  #     env: WITHTESTS=1
  # allow_failures:
  #   - node_js: 4

cache:
  directories:
    - node_modules

before_install:
  - npm config set spin false

#before_script:
#  - npm install -g npm
#  - npm install -g gulp

install:
  - npm install
  - npm install -g codecov
  - npm install -g bithound

script:
# - gulp build
  - npm run lint
  - npm test
  - npm run coverage
  - bithound check git@github.com:$TRAVIS_REPO_SLUG.git || /bin/true

after_success:
  - codecov

deploy:
  provider: npm
  api_key:
    secure: "A8tEwsmGyf+fTIMrcZWylx5S0MR9jvbQ1nQ6ECB5Du2TtwU5L4necbH4da2TKlFGQpLM/YwituPafqnjPbYw9kRBmMaRZ5TYeaZDjrxZpz1+qcNeZWKvhbi/Bo4DV9mlk9zGHi5t5L7T3X8jBDC5BO/B78BfcFanGwVrzo0zM/zLhhgrIgAa7LZzDtSwM+L+wGa0hKKmfulVL4i2hm2HyjndAFUBY/qMUjpyAd+EQSiHiQ+dY0jBLoRBTGYrIiwDW4dQOKvRSI1HV4kS3Ny2QLLs2pQdOJ4OwYneQ0cJjmU447d27lgVGsVXlRkSxI8NPvfw4guYu/e2fv7XdWVg2wv6gZqBZ38G1R9FdgH7mYsub3RysrsGjX4UFO2WYnYJFio4nWnon+AnXfIyV3tqOx0e4depZxD49FQ1f6Gy39x+jq9Hrh0l+Jop7y04e+hbWmAz1sVTzi7LIuifRolXWwAn/7imvGzLjRCSApvFYOGRUqllJUhTQAwgysBeBKLUTMjY6v1g8ajv42sAEwKBjHSMJj3AMCIY+0j2zbzMyaISzawxIfmq+lOK0z4cDeoPboWWw2OAlTNugJZcZWRaaChx+ML5gjHiWEf3e5REy5TEnFX+KGHDXyzLavhbYGT9yiDxOqme5O0p/UpHFZneBk1qjy//JRPkC5gG4TRjxw0="
  email:
    secure: "Qha4UmPSbAvdW3Al4BMc6y++lBwr0mgfgkseZ10Gc9K2espOOZRwyKnULpzyjVzkYUqMlvGBSi1FSUmwBJa3sMYoZ++DHzBNcl1hlaTBuCupHB3ZSAEX1WJhBcNEm+bYuaR6WCfHuvMCiQNu+E+M6dqhuykMwI/yBu8sJGfpDkMvJNovG4zMnFCCAyzYlkJyqLA8X5Krjv/h/+nOZ/Nf7r6WJSSNOMgADGDbqkeK3ppKuWBlXg1rjhDBwQcE8rqkccLa6FlHsL16wztCwlulm5aT4sCBsA8z6nD75zJxbUlQzJD+CYo0eLZKCyl8Eq3tUuF6xfRMbNKfCbh8pUtiq5JIQAGgG27gQeJqHpFGCNxPrbz05x3BHkOj87uxx83MwlSP5zhhDKa6j/Ts0lG2zTdlTddR9qpIXZt9P1s53p1D+ryLQKzcMSZsDmwesSQpHeO8k4KOXlGGVMulpbf3/H3yhKDQ0ZTET/30OrSx5ePzditL6VK8OeP5MPxJ8o0XcgImr1HOvLHU4pI3cVu6SzkDfmdPeIG+ylSfH/b4fFHWKjaPUzbf5FbLHhBX6LcvBKs8w5MiIUhjgo1vvGIAROgflOK3H6ko5ViPQab4vXXdhgYnPgykgGxpnSpVrBxn6s7kIRG1cR2y67ykp42gnFNoKXdRzkz2Nz4Mm3YHQxI="
  on:
    tags: true
    node_js: 8
    repo: volebo/volebo-express

after_deploy:
  # Send notification to Slack:
  - curl -sL https://raw.githubusercontent.com/volebo/dev/master/scripts/im/slack-publish.sh | bash -s -
